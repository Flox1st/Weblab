<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Английский язык - Лампадка</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="https://lampada-obr.ru/images/demo/logo.png" alt="Логотип">
        </div>
        <div class="site-name">Ховринская Гимназия "Лампадка"</div>
        <div class="login-form">
            <input type="text" placeholder="Логин">
            <input type="password" placeholder="Пароль">
            <button>Войти</button>
        </div>
    </header>

    <nav class="nav-bar">
        <a href="index.html">Главная</a>
        <a href="program.html">Образовательная программа</a>
        <a href="teachers.html">Каталог преподавателей</a>
        <a href="contacts.html">Контакты</a>
    </nav>

    <div class="content">
        <div class="sidebar">
            <a href="index.html">Главная</a>
            <a href="program.html">Образовательная программа</a>
            <a href="english.html">Английский язык</a>
            <a href="auth.html" id="sidebarAuthLink">Личный кабинет</a>
        </div>

        <div class="main-content">
            <h1>Программа углубленного изучения английского языка</h1>

            <h2>Описание программы</h2>

            <div class="text-with-image">
                <img src="https://lampada-obr.ru/images/s1/gimnazia03.jpg" alt="Урок английского" class="content-image">
                <p>Уникальная программа изучения английского языка с использованием британских учебников и методик, разработанная совместно с преподавателями МГЛУ.</p>
            </div>

            <h2>Характеристики программы</h2>

            <div class="product-features">
                <ul class="square-list">
                    <li><strong>Количество часов в неделю:</strong> 5-6 академических часов</li>
                    <li><strong>Учебные материалы:</strong> Cambridge University Press</li>
                    <li><strong>Уровень преподавателей:</strong> CELTA, МГЛУ</li>
                    <li><strong>Формы работы:</strong> интерактивные занятия, проекты</li>
                    <li><strong>Дополнительно:</strong> разговорные клубы, театр на английском</li>
                </ul>
            </div>

            <h2>Методические особенности</h2>
            <div class="product-special">
                <ul class="circle-list">
                    <li>Коммуникативный подход в обучении</li>
                    <li>Раннее погружение в языковую среду</li>
                    <li>Интеграция с другими предметами</li>
                    <li>Подготовка к международным экзаменам</li>
                    <li>Использование современных технологий</li>
                </ul>
            </div>

            <h2>Подробное описание программы</h2>

            <div class="product-details">
                <p>Наша программа по английскому языку разработана с учетом лучших международных практик. С первого класса дети погружаются в языковую среду через игры, песни и творческие задания.</p>

                <p>Мы используем аутентичные учебные материалы издательства Cambridge University Press, что обеспечивает соответствие международным стандартам. Наши преподаватели имеют сертификаты CELTA и опыт работы в ведущих языковых школах.</p>

                <p>К четвертому классу наши ученики свободно общаются на бытовые темы, читают адаптированную литературу и готовы к сдаче первых международных экзаменов.</p>
            </div>

            <hr>

            <p class="copyright">Все права защищены</p>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Лампадка. Все права защищены.</p>
        </div>
    </footer>
<script>
    // Простая проверка авторизации для навигации
    document.addEventListener('DOMContentLoaded', function() {
        const user = localStorage.getItem('user');
        const authLinks = document.querySelectorAll('a[href="auth.html"]');

        if (user) {
            authLinks.forEach(link => {
                link.href = 'profile.html';
                link.textContent = 'Личный кабинет';
            });
        }
    });
</script>
<script src="header-auth.js"></script>
<script>
// Глобальные переменные для хранения состояния
let currentUser = null;
let authToken = localStorage.getItem('authToken');

// Функция для проверки авторизации
async function checkAuth() {
    if (!authToken) {
        return false;
    }

    try {
        const response = await fetch('/api/users/me', {
            headers: {
                'Authorization': `Bearer ${authToken}`
            }
        });

        if (response.ok) {
            const userData = await response.json();
            currentUser = userData;
            updateAuthUI();
            return true;
        } else {
            localStorage.removeItem('authToken');
            authToken = null;
            return false;
        }
    } catch (error) {
        console.error('Auth check failed:', error);
        return false;
    }
}

// Функция для обновления UI в зависимости от авторизации
function updateAuthUI() {
    const loginForm = document.querySelector('.login-form');
    const userView = document.getElementById('userView');
    const userGreeting = document.getElementById('userGreeting');

    if (currentUser) {
        loginForm.style.display = 'none';
        userView.style.display = 'block';
        userGreeting.textContent = `Добро пожаловать, ${currentUser.full_name}!`;
    } else {
        loginForm.style.display = 'flex';
        userView.style.display = 'none';
    }
}

// Функция входа
async function handleLogin() {
    const loginInput = document.getElementById('loginInput');
    const passwordInput = document.getElementById('passwordInput');

    try {
        const response = await fetch('/api/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                username: loginInput.value,
                password: passwordInput.value
            })
        });

        if (response.ok) {
            const data = await response.json();
            authToken = data.access_token;
            currentUser = data.user;

            localStorage.setItem('authToken', authToken);
            updateAuthUI();

            // Очищаем поля
            loginInput.value = '';
            passwordInput.value = '';
        } else {
            const errorData = await response.json();
            alert(`Ошибка входа: ${errorData.detail}`);
        }
    } catch (error) {
        console.error('Login error:', error);
        alert('Ошибка соединения с сервером');
    }
}

// Функция выхода
function handleLogout() {
    localStorage.removeItem('authToken');
    authToken = null;
    currentUser = null;
    updateAuthUI();
}

// Функция регистрации
async function handleRegister() {
    // Можно добавить модальное окно для регистрации
    const username = prompt('Введите имя пользователя:');
    const email = prompt('Введите email:');
    const password = prompt('Введите пароль:');
    const fullName = prompt('Введите полное имя:');

    if (username && email && password && fullName) {
        try {
            const response = await fetch('/api/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    username: username,
                    email: email,
                    password: password,
                    full_name: fullName,
                    role: 'student'
                })
            });

            if (response.ok) {
                alert('Регистрация успешна! Теперь вы можете войти.');
            } else {
                const errorData = await response.json();
                alert(`Ошибка регистрации: ${errorData.detail}`);
            }
        } catch (error) {
            console.error('Registration error:', error);
            alert('Ошибка соединения с сервером');
        }
    }
}

// Добавляем кнопку регистрации в HTML
document.addEventListener('DOMContentLoaded', function() {
    // Добавляем кнопку регистрации в форму логина
    const loginForm = document.querySelector('.login-form');
    const registerButton = document.createElement('button');
    registerButton.type = 'button';
    registerButton.textContent = 'Регистрация';
    registerButton.style.marginTop = '5px';
    registerButton.style.padding = '3px 8px';
    registerButton.style.fontSize = '12px';
    registerButton.style.background = 'transparent';
    registerButton.style.border = '1px solid #fff';
    registerButton.style.color = '#fff';
    registerButton.style.cursor = 'pointer';
    registerButton.onclick = handleRegister;

    loginForm.appendChild(registerButton);

    // Проверяем авторизацию при загрузке
    checkAuth();
});
</script>
<script src="/static/auth.js"></script>
</body>
</html>