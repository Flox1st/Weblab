<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ховринская Гимназия "Лампада" - Школьный магазин</title>
    <link rel="stylesheet" href="/static/style.css">
    <!-- Иконочный шрифт для кнопок -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Шапка сайта -->
    <header class="school-header">
        <div class="header-container">
            <div class="logo-section">
                <div class="school-logo">
                    <div class="logo-placeholder">Л</div>
                </div>
                <div class="school-titles">
                    <h1 class="school-name">Ховринская Гимназия "Лампада"</h1>
                    <p class="school-motto">Знание - свет, а незнание - тьма</p>
                </div>
            </div>

           <div class="auth-section">
                <!-- Форма авторизации (показывается если пользователь не вошел) -->
                <div class="login-form" id="loginForm">
                    <input type="text" placeholder="Логин" id="loginInput">
                    <input type="password" placeholder="Пароль" id="passwordInput">
                    <button onclick="handleLogin()">Войти</button>
                    <a href="/register" style="margin-top: 8px; text-align: center; display: block; color: white; font-size: 12px; text-decoration: none;">
                        Регистрация
                    </a>
                </div>
                <!-- Информация о пользователе (показывается если пользователь вошел) -->
                <div class="user-view" id="userView" style="display: none;">
                    <span id="userGreeting"></span>
                    <button onclick="handleLogout()">Выйти</button>
                </div>
                
                <!-- Иконка корзины -->
                <div class="cart-icon">
                    <a href="cart.html" class="cart-link">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Корзина</span>
                        <span class="cart-count" id="cartCount">0</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Основная навигация -->
    <nav class="main-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-link">Главная</a>
            <a href="products.html" class="nav-link active">Школьный магазин</a>
            <a href="about.html" class="nav-link">О гимназии</a>
            <a href="teachers.html" class="nav-link">Преподаватели</a>
            <a href="news.html" class="nav-link">Новости</a>
            <a href="students.html" class="nav-link">Ученикам</a>
            <a href="parents.html" class="nav-link">Родителям</a>
            <a href="contacts.html" class="nav-link">Контакты</a>
        </div>
    </nav>

    <!-- Основной контент -->
    <div class="products-page">
        <div class="products-container">
            <!-- Заголовок -->
            <div class="products-header">
                <h1>Школьный магазин</h1>
                <p>Приобретайте учебные материалы, форму и принадлежности для успешной учебы</p>
            </div>

            <!-- Фильтры -->
            <div class="products-filters">
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="categoryFilter">Категория:</label>
                        <select id="categoryFilter" class="filter-select">
                            <option value="all">Все товары</option>
                            <option value="books">Учебная литература</option>
                            <option value="uniform">Школьная форма</option>
                            <option value="stationery">Канцелярия</option>
                            <option value="accessories">Аксессуары</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="sortFilter">Сортировка:</label>
                        <select id="sortFilter" class="filter-select">
                            <option value="popular">По популярности</option>
                            <option value="price-asc">По возрастанию цены</option>
                            <option value="price-desc">По убыванию цены</option>
                            <option value="name">По названию</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Сетка товаров -->
            <div class="products-grid" id="productsGrid">
                <!-- Товар 1 -->
                <div class="product-card" data-category="books" data-id="1">
                    <div class="product-image">
                        <!-- Замените src на путь к вашей картинке -->
                        <img src="/static/images/products/textbook.jpg" alt="Учебник по математике">
                        <div class="image-placeholder" style="display: none;">
                            Учебник по математике<br>
                            Путь: /static/images/products/textbook.jpg
                        </div>
                    </div>
                    <div class="product-details">
                        <h3 class="product-title">Учебник по математике 5 класс</h3>
                        <p class="product-description">Учебник соответствует ФГОС, включает задания повышенной сложности и тестовые работы</p>
                        <div class="product-price">850 ₽</div>
                        <div class="product-meta">
                            <span class="product-category">Учебная литература</span>
                            <span class="product-stock">В наличии</span>
                        </div>
                        <button class="add-to-cart-btn" onclick="addToCart(1)">
                            <i class="fas fa-cart-plus"></i>
                            В корзину
                        </button>
                    </div>
                </div>

                <!-- Товар 2 -->
                <div class="product-card" data-category="uniform" data-id="2">
                    <div class="product-image">
                        <!-- Замените src на путь к вашей картинке -->
                        <img src="/static/images/products/uniform.jpg" alt="Школьная форма">
                        <div class="image-placeholder" style="display: none;">
                            Школьная форма<br>
                            Путь: /static/images/products/uniform.jpg
                        </div>
                    </div>
                    <div class="product-details">
                        <h3 class="product-title">Школьная форма (девичья)</h3>
                        <p class="product-description">Классический сарафан с жилетом, ткань - габардин, размеры: 32-44</p>
                        <div class="product-price">2 990 ₽</div>
                        <div class="product-meta">
                            <span class="product-category">Школьная форма</span>
                            <span class="product-stock">В наличии</span>
                        </div>
                        <button class="add-to-cart-btn" onclick="addToCart(2)">
                            <i class="fas fa-cart-plus"></i>
                            В корзину
                        </button>
                    </div>
                </div>

                <!-- Товар 3 -->
                <div class="product-card" data-category="stationery" data-id="3">
                    <div class="product-image">
                        <!-- Замените src на путь к вашей картинке -->
                        <img src="/static/images/products/notebooks.jpg" alt="Тетради">
                        <div class="image-placeholder" style="display: none;">
                            Набор тетрадей<br>
                            Путь: /static/images/products/notebooks.jpg
                        </div>
                    </div>
                    <div class="product-details">
                        <h3 class="product-title">Набор тетрадей 48л. (10 шт.)</h3>
                        <p class="product-description">Тетради в клетку и линейку, обложка - плотный картон с ламинацией</p>
                        <div class="product-price">450 ₽</div>
                        <div class="product-meta">
                            <span class="product-category">Канцелярия</span>
                            <span class="product-stock">В наличии</span>
                        </div>
                        <button class="add-to-cart-btn" onclick="addToCart(3)">
                            <i class="fas fa-cart-plus"></i>
                            В корзину
                        </button>
                    </div>
                </div>

                <!-- Товар 4 -->
                <div class="product-card" data-category="books" data-id="4">
                    <div class="product-image">
                        <!-- Замените src на путь к вашей картинке -->
                        <img src="/static/images/products/russian_book.jpg" alt="Учебник по русскому языку">
                        <div class="image-placeholder" style="display: none;">
                            Учебник по русскому языку<br>
                            Путь: /static/images/products/russian_book.jpg
                        </div>
                    </div>
                    <div class="product-details">
                        <h3 class="product-title">Учебник по русскому языку 6 класс</h3>
                        <p class="product-description">Комплексный курс с упражнениями для подготовки к контрольным работам</p>
                        <div class="product-price">790 ₽</div>
                        <div class="product-meta">
                            <span class="product-category">Учебная литература</span>
                            <span class="product-stock">В наличии</span>
                        </div>
                        <button class="add-to-cart-btn" onclick="addToCart(4)">
                            <i class="fas fa-cart-plus"></i>
                            В корзину
                        </button>
                    </div>
                </div>

                <!-- Товар 5 -->
                <div class="product-card" data-category="accessories" data-id="5">
                    <div class="product-image">
                        <!-- Замените src на путь к вашей картинке -->
                        <img src="/static/images/products/backpack.jpg" alt="Школьный рюкзак">
                        <div class="image-placeholder" style="display: none;">
                            Школьный рюкзак<br>
                            Путь: /static/images/products/backpack.jpg
                        </div>
                    </div>
                    <div class="product-details">
                        <h3 class="product-title">Школьный рюкзак с ортопедической спинкой</h3>
                        <p class="product-description">Эргономичный дизайн, водонепроницаемый материал, светоотражающие элементы</p>
                        <div class="product-price">3 200 ₽</div>
                        <div class="product-meta">
                            <span class="product-category">Аксессуары</span>
                            <span class="product-stock">В наличии</span>
                        </div>
                        <button class="add-to-cart-btn" onclick="addToCart(5)">
                            <i class="fas fa-cart-plus"></i>
                            В корзину
                        </button>
                    </div>
                </div>

                <!-- Товар 6 -->
                <div class="product-card" data-category="stationery" data-id="6">
                    <div class="product-image">
                        <!-- Замените src на путь к вашей картинке -->
                        <img src="/static/images/products/pens_set.jpg" alt="Набор ручек">
                        <div class="image-placeholder" style="display: none;">
                            Набор гелевых ручек<br>
                            Путь: /static/images/products/pens_set.jpg
                        </div>
                    </div>
                    <div class="product-details">
                        <h3 class="product-title">Набор гелевых ручек (12 цветов)</h3>
                        <p class="product-description">Яркие цвета, тонкий пишущий узел 0.5мм, эргономичный корпус</p>
                        <div class="product-price">280 ₽</div>
                        <div class="product-meta">
                            <span class="product-category">Канцелярия</span>
                            <span class="product-stock">В наличии</span>
                        </div>
                        <button class="add-to-cart-btn" onclick="addToCart(6)">
                            <i class="fas fa-cart-plus"></i>
                            В корзину
                        </button>
                    </div>
                </div>
            </div>

            <!-- Информация о доставке -->
            <div class="card" style="text-align: center;">
                <h3>Условия доставки</h3>
                <p>• Бесплатная доставка по гимназии • Самовывоз со склада • Доставка по Москве - 300 ₽ • Оплата наличными или картой</p>
            </div>
        </div>
    </div>

    <!-- Подвал -->
    <footer class="school-footer">
        <div class="footer-container">
            <div class="footer-info">
                <p>&copy; 2025 Ховринская Гимназия "Лампада". Все права защищены.</p>
                <p>Телефон: +7 (495) 123-45-67 | Email: info@lampada-gymnasium.ru</p>
            </div>
        </div>
    </footer>

    <!-- Базовый скрипт для корзины -->
    <script>
        // Базовая структура корзины
        let cart = {
            items: [],
            total: 0,
            count: 0
        };

        // Загружаем корзину из localStorage
        function loadCart() {
            const savedCart = localStorage.getItem('schoolCart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartCount();
            }
        }

        // Сохраняем корзину в localStorage
        function saveCart() {
            localStorage.setItem('schoolCart', JSON.stringify(cart));
            updateCartCount();
        }

        // Обновляем счетчик в шапке
        function updateCartCount() {
            const cartCountElement = document.getElementById('cartCount');
            if (cartCountElement) {
                cartCountElement.textContent = cart.count;
            }
        }

        // Добавление товара в корзину
        function addToCart(productId) {
            const productCard = document.querySelector(`.product-card[data-id="${productId}"]`);
            if (!productCard) return;

            const title = productCard.querySelector('.product-title').textContent;
            const priceText = productCard.querySelector('.product-price').textContent;
            const price = parseInt(priceText.replace(/[^\d]/g, ''));
            const image = productCard.querySelector('.product-image img').src;

            // Ищем товар в корзине
            const existingItem = cart.items.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.items.push({
                    id: productId,
                    title: title,
                    price: price,
                    image: image,
                    quantity: 1
                });
            }

            // Пересчитываем итоги
            recalculateCart();
            
            // Сохраняем
            saveCart();
            
            // Анимация кнопки
            const button = productCard.querySelector('.add-to-cart-btn');
            button.innerHTML = '<i class="fas fa-check"></i> Добавлено';
            button.style.background = 'var(--success-green)';
            
            setTimeout(() => {
                button.innerHTML = '<i class="fas fa-cart-plus"></i> В корзину';
                button.style.background = '';
            }, 1500);
            
            // Показываем уведомление
            showNotification(`"${title}" добавлен в корзину`);
        }

        // Пересчет корзины
        function recalculateCart() {
            cart.count = cart.items.reduce((sum, item) => sum + item.quantity, 0);
            cart.total = cart.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        }

        // Показать уведомление
        function showNotification(message) {
            // Создаем уведомление
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <div style="
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--primary-blue);
                    color: white;
                    padding: 15px 20px;
                    border-radius: var(--radius-md);
                    box-shadow: var(--shadow-lg);
                    z-index: 1000;
                    animation: slideIn 0.3s ease;
                ">
                    <i class="fas fa-check-circle" style="margin-right: 10px;"></i>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            loadCart();
            
            // Обработчики фильтров
            document.getElementById('categoryFilter')?.addEventListener('change', filterProducts);
            document.getElementById('sortFilter')?.addEventListener('change', sortProducts);
        });

        // Фильтрация товаров
        function filterProducts() {
            const category = document.getElementById('categoryFilter').value;
            const products = document.querySelectorAll('.product-card');
            
            products.forEach(product => {
                const productCategory = product.dataset.category;
                
                if (category === 'all' || category === productCategory) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
        }

        // Сортировка товаров
        function sortProducts() {
            const sortBy = document.getElementById('sortFilter').value;
            const grid = document.getElementById('productsGrid');
            const products = Array.from(document.querySelectorAll('.product-card'));
            
            products.sort((a, b) => {
                switch(sortBy) {
                    case 'price-asc':
                        const priceA = parseInt(a.querySelector('.product-price').textContent.replace(/[^\d]/g, ''));
                        const priceB = parseInt(b.querySelector('.product-price').textContent.replace(/[^\d]/g, ''));
                        return priceA - priceB;
                        
                    case 'price-desc':
                        const priceA2 = parseInt(a.querySelector('.product-price').textContent.replace(/[^\d]/g, ''));
                        const priceB2 = parseInt(b.querySelector('.product-price').textContent.replace(/[^\d]/g, ''));
                        return priceB2 - priceA2;
                        
                    case 'name':
                        const nameA = a.querySelector('.product-title').textContent.toLowerCase();
                        const nameB = b.querySelector('.product-title').textContent.toLowerCase();
                        return nameA.localeCompare(nameB);
                        
                    default: // popular
                        return 0;
                }
            });
            
            // Переставляем товары в сетке
            products.forEach(product => {
                grid.appendChild(product);
            });
        }

        // Добавляем CSS для анимации уведомления
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
<script src="/static/auth.js"></script>  
<script>
    // Проверка авторизации при загрузке
    document.addEventListener('DOMContentLoaded', function() {
        checkAuthState();
    });
</script>
</body>
</html>